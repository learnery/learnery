<%- model_class = Learnery::Event -%>

  <h1><small><%=t :manage %></small><br> <%= @event.name %> <small><%=l @event.starts, format: :long %></small></h1>

  <%=md  @event.description %>

  <dl class="dl-horizontal">
    <dt><strong><%= model_class.human_attribute_name(:starts) %>:</strong></dt>
    <dd><%= @event.starts %></dd>

    <% if ! @event.ends.nil? %>
      <dt><strong><%= model_class.human_attribute_name(:ends) %>:</strong></dt>
      <dd><%= @event.ends %></dd>
    <% end %>

    <% if ! @event.venue.blank? %>
      <dt><strong><%= model_class.human_attribute_name(:venue) %>:</strong></dt>
      <dd><%= @event.venue %></dd>
    <% end %>


    <% if (@event.topics.empty?) %>
      <dt><strong><%=t 'topics.none'%></strong></dt>
    <% else %>
      <dt><strong><%= model_class.human_attribute_name(:topics) %>:</strong></dt>
      <dd>
        <% @event.topics.each do |topic| %>
          <%= link_to topic.name.strip, topic %> |
        <% end %>
      </dd>
    <% end %>

  </dl>

  <h2>Rsvp's</h2>
  <p><%=t @event.rsvp_type, :scope => 'activerecord.models' %></p>
  <p><i>&quot;<%= event_rsvp_type_explanation( @event.rsvp_type )%>&quot;</i></p>

  <% @rsvps.group_by(&:answer).each do |answer, list| %>
    <h3><%= list.count %> x <%= answer %></h3>
    <% list.each do |r| %>
       <p><b><%= r.user.name %></b> <%= r.user.firstname %> <%= r.user.lastname %> <%= r.user.email %> <%=l(r.asked_at ||r.created_at, :format => :short ) %></p>
    <% end %>
  <% end %>


  <div class="form-actions">
    <%= link_to t(:back), event_path(@event), :class => 'btn'  %>
    <%= link_to t('topic.new.suggest'), new_topic_path(event: @event), :class => 'btn'  %>
    <%= link_to t(:destroy), admin_event_path(@event),
                :method => 'delete',
                :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                :class => 'btn btn-danger' %>
  </div>

</div>
